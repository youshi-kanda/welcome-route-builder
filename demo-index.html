<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALSOK Demo System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div id="home-screen" class="max-w-lg mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-8 text-center">
                <h1 class="text-3xl font-bold text-gray-900 mb-4">
                    ğŸ›¡ï¸ ALSOK Demo System
                </h1>
                <p class="text-gray-600 mb-8">
                    å®Œå…¨ãªæ¡ç”¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                </p>
                
                <div class="space-y-4">
                    <button onclick="showAdminScreen()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                        PCç®¡ç†ç”»é¢
                    </button>
                    
                    <button onclick="showPhoneScreen()" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                        é›»è©±å—ä»˜
                    </button>
                    
                    <button onclick="showMobileScreen()" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                        ãƒ¢ãƒã‚¤ãƒ«ç”³è¾¼
                    </button>
                </div>
                
                <p class="text-sm text-gray-500 mt-6">
                    â€» ç¾åœ¨é–‹ç™ºæ©Ÿèƒ½ã§ã™ã€‚å®Œå…¨ãªãƒ‡ãƒ¢ã«ã¯QRã‚³ãƒ¼ãƒ‰ã‹ã‚‰å„æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
                </p>
            </div>
        </div>

        <!-- Admin Screen -->
        <div id="admin-screen" class="hidden max-w-6xl mx-auto">
            <div class="flex items-center justify-between mb-6">
                <button onclick="showHomeScreen()" class="flex items-center px-4 py-2 text-gray-600 hover:text-gray-800">
                    â† ãƒ‡ãƒ¢ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
                </button>
                <button onclick="refreshData()" class="flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg">
                    ğŸ”„ æ›´æ–°
                </button>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 space-y-6">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-white rounded-lg p-4 text-center shadow">
                            <div class="text-2xl mb-2">ğŸ‘¥</div>
                            <p class="text-2xl font-bold" id="total-count">0</p>
                            <p class="text-sm text-gray-600">ç·å¿œå‹Ÿè€…æ•°</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 text-center shadow">
                            <div class="text-2xl mb-2">ğŸ’¬</div>
                            <p class="text-2xl font-bold" id="sms-count">0</p>
                            <p class="text-sm text-gray-600">SMSé€ä¿¡</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 text-center shadow">
                            <div class="text-2xl mb-2">ğŸ“</div>
                            <p class="text-2xl font-bold" id="interview-count">0</p>
                            <p class="text-sm text-gray-600">é¢æ¥é–‹å§‹</p>
                        </div>
                        <div class="bg-white rounded-lg p-4 text-center shadow">
                            <div class="text-2xl mb-2">âœ…</div>
                            <p class="text-2xl font-bold" id="completed-count">0</p>
                            <p class="text-sm text-gray-600">é¢æ¥å®Œäº†</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg p-6 shadow">
                        <h3 class="text-lg font-semibold mb-4">å¿œå‹Ÿè€…ä¸€è¦§</h3>
                        <div id="applicants-list">
                            <div class="text-center py-8 text-gray-500">
                                <div class="text-4xl mb-4">ğŸ“</div>
                                <p>ã¾ã å¿œå‹Ÿè€…ãŒã„ã¾ã›ã‚“</p>
                                <p class="text-sm">é›»è©±å—ä»˜ã¾ãŸã¯QRã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ‡ãƒ¢ã‚’é–‹å§‹ã—ã¦ãã ã•ã„</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="bg-white rounded-lg p-6 shadow">
                        <h3 class="text-lg font-semibold mb-4">é¢æ¥QRã‚³ãƒ¼ãƒ‰</h3>
                        <div class="text-center">
                            <div id="qrcode" class="mb-4"></div>
                            <p class="text-sm text-gray-600 mb-4">
                                ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦é¢æ¥ã‚’é–‹å§‹
                            </p>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg p-6 shadow">
                        <h3 class="text-lg font-semibold mb-4">ãƒ‡ãƒ¢ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h3>
                        <div class="space-y-3">
                            <button onclick="showPhoneScreen()" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg">
                                ğŸ“ é›»è©±å—ä»˜ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                            </button>
                            <button onclick="showMobileScreen()" class="w-full bg-orange-600 hover:bg-orange-700 text-white py-2 px-4 rounded-lg">
                                ğŸ’¬ ãƒ¢ãƒã‚¤ãƒ«é¢æ¥ä½“é¨“
                            </button>
                            <button onclick="clearDemoData()" class="w-full border border-red-200 text-red-600 hover:bg-red-50 py-2 px-4 rounded-lg">
                                ğŸ—‘ï¸ ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Phone Screen -->
        <div id="phone-screen" class="hidden max-w-md mx-auto">
            <button onclick="showHomeScreen()" class="flex items-center px-4 py-2 text-gray-600 hover:text-gray-800 mb-4">
                â† ãƒ‡ãƒ¢ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
            </button>

            <div class="bg-white rounded-lg p-6 shadow-lg">
                <div class="text-center mb-6">
                    <h2 class="text-xl font-bold">ğŸ“ é›»è©±å—ä»˜ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                </div>

                <div id="phone-form">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">ãŠåå‰</label>
                            <input type="text" id="phone-name" class="w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="å±±ç”°å¤ªéƒ">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">é›»è©±ç•ªå·</label>
                            <input type="tel" id="phone-number" class="w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="090-1234-5678">
                        </div>
                        <button onclick="startCall()" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg">
                            ğŸ“ ALSOKæ¡ç”¨çª“å£ã«é›»è©±ã‚’ã‹ã‘ã‚‹
                        </button>
                    </div>
                </div>

                <div id="phone-call" class="hidden text-center py-8">
                    <div class="text-6xl mb-4" id="call-emoji">ğŸ“</div>
                    <p class="text-lg font-medium mb-4" id="call-status">å‘¼ã³å‡ºã—ä¸­...</p>
                    <div id="call-completed" class="hidden">
                        <div class="text-6xl mb-4">âœ…</div>
                        <p class="text-sm text-gray-600 mb-4">
                            PCç®¡ç†ç”»é¢ã§QRã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã€<br>
                            ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã§ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦é¢æ¥ã‚’é–‹å§‹ã—ã¦ãã ã•ã„
                        </p>
                        <button onclick="showAdminScreen()" class="w-full border border-gray-300 hover:bg-gray-50 py-2 px-4 rounded-lg">
                            PCç®¡ç†ç”»é¢ã‚’è¦‹ã‚‹
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Screen -->
        <div id="mobile-screen" class="hidden max-w-md mx-auto">
            <button onclick="showHomeScreen()" class="flex items-center px-4 py-2 text-gray-600 hover:text-gray-800 mb-4">
                â† ãƒ‡ãƒ¢ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
            </button>

            <div id="mobile-interview" class="bg-white rounded-lg p-6 shadow-lg">
                <div class="text-center mb-6">
                    <h2 class="text-xl font-bold">ğŸ“± AIé¢æ¥ã‚·ã‚¹ãƒ†ãƒ </h2>
                    <p class="text-sm text-gray-600">è³ªå• <span id="current-q">1</span> / 5</p>
                </div>

                <div class="w-full bg-gray-200 rounded-full h-2 mb-6">
                    <div id="progress-bar" class="bg-orange-600 h-2 rounded-full transition-all duration-300" style="width: 20%"></div>
                </div>

                <div class="mb-6">
                    <label class="block text-base font-medium mb-2">è³ªå•</label>
                    <div class="p-4 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                        <p id="current-question">è‡ªå·±ç´¹ä»‹ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼ˆãŠåå‰ã€å¹´é½¢ã€è·æ­´ãªã©ï¼‰</p>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium mb-2">å›ç­”</label>
                    <textarea id="current-answer" class="w-full min-h-[120px] border border-gray-300 rounded-lg px-3 py-2" placeholder="ã“ã¡ã‚‰ã«å›ç­”ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
                </div>

                <button onclick="nextQuestion()" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg">
                    ğŸ“¤ <span id="next-btn-text">æ¬¡ã®è³ªå•ã¸</span>
                </button>

                <div class="mt-4 text-sm text-gray-600">
                    å›ç­”æ¸ˆã¿: <span id="answered-count">0</span>å•
                </div>
            </div>

            <div id="mobile-completed" class="hidden bg-white rounded-lg p-6 shadow-lg text-center">
                <div class="text-6xl mb-4">âœ…</div>
                <h2 class="text-2xl font-bold mb-2">é¢æ¥å®Œäº†ï¼</h2>
                <p class="text-gray-600 mb-4">
                    ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚<br>
                    çµæœã¯å¾Œæ—¥ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚
                </p>
                <p class="text-sm text-gray-500 mb-6">
                    å¿œå‹Ÿè€…ID: <span id="applicant-id"></span>
                </p>
                <button onclick="showHomeScreen()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg">
                    ãƒ‡ãƒ¢ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
                </button>
            </div>
        </div>
    </div>

    <script>
        // Demo data storage
        let demoData = {
            applicants: []
        };

        let currentQuestionIndex = 0;
        let responses = [];
        
        const questions = [
            "è‡ªå·±ç´¹ä»‹ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼ˆãŠåå‰ã€å¹´é½¢ã€è·æ­´ãªã©ï¼‰",
            "è­¦å‚™æ¥­ã«èˆˆå‘³ã‚’æŒã£ãŸãã£ã‹ã‘ã‚’æ•™ãˆã¦ãã ã•ã„",
            "å¤œå‹¤ã‚„ä¸è¦å‰‡ãªå‹¤å‹™æ™‚é–“ã«å¯¾å¿œã§ãã¾ã™ã‹ï¼Ÿ",
            "ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’é‡è¦–ã™ã‚‹å ´é¢ã§ã®çµŒé¨“ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
            "æœ€å¾Œã«ã€ALSOKã§åƒãæ„æ°—è¾¼ã¿ã‚’èã‹ã›ã¦ãã ã•ã„"
        ];

        // Screen management
        function showScreen(screenId) {
            document.querySelectorAll('[id$="-screen"]').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        function showHomeScreen() {
            showScreen('home-screen');
        }

        function showAdminScreen() {
            showScreen('admin-screen');
            generateQRCode();
            updateAdminDashboard();
        }

        function showPhoneScreen() {
            showScreen('phone-screen');
            document.getElementById('phone-form').classList.remove('hidden');
            document.getElementById('phone-call').classList.add('hidden');
        }

        function showMobileScreen() {
            showScreen('mobile-screen');
            document.getElementById('mobile-interview').classList.remove('hidden');
            document.getElementById('mobile-completed').classList.add('hidden');
            resetInterview();
        }

        // QR Code generation
        function generateQRCode() {
            const qrContainer = document.getElementById('qrcode');
            const mobileUrl = window.location.origin + window.location.pathname + '#mobile';
            
            if (typeof qrcode !== 'undefined') {
                const qr = qrcode(0, 'M');
                qr.addData(mobileUrl);
                qr.make();
                qrContainer.innerHTML = qr.createSvgTag({
                    cellSize: 4,
                    margin: 0,
                    scalable: true
                });
            } else {
                qrContainer.innerHTML = '<div class="w-48 h-48 bg-gray-200 flex items-center justify-center rounded-lg">QRã‚³ãƒ¼ãƒ‰</div>';
            }
        }

        // Phone simulation
        function startCall() {
            const name = document.getElementById('phone-name').value;
            const phone = document.getElementById('phone-number').value;

            if (!name || !phone) {
                alert('åå‰ã¨é›»è©±ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            document.getElementById('phone-form').classList.add('hidden');
            document.getElementById('phone-call').classList.remove('hidden');

            const statuses = [
                { text: "ğŸ“ å‘¼ã³å‡ºã—ä¸­...", emoji: "ğŸ“" },
                { text: "ğŸ¤– ALSOKã§ã™ã€‚æ¡ç”¨é¢æ¥ã®ãŠç”³ã—è¾¼ã¿ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™", emoji: "ğŸ¤–" },
                { text: "ğŸ“± SMSé€ä¿¡ä¸­...", emoji: "ğŸ“±" },
                { text: "âœ… å®Œäº†ï¼QRã‚³ãƒ¼ãƒ‰ã‚’PCç®¡ç†ç”»é¢ã§ã”ç¢ºèªãã ã•ã„", emoji: "âœ…" }
            ];

            let step = 0;
            const interval = setInterval(() => {
                if (step < statuses.length) {
                    document.getElementById('call-emoji').textContent = statuses[step].emoji;
                    document.getElementById('call-status').textContent = statuses[step].text;
                    step++;
                } else {
                    clearInterval(interval);
                    
                    // Add applicant to demo data
                    const applicantId = 'APP' + Date.now().toString().slice(-6);
                    demoData.applicants.push({
                        id: applicantId,
                        name: name,
                        phone: phone,
                        status: 'sms_sent',
                        created_at: new Date().toISOString(),
                        interview_responses: [],
                        sms_count: 1
                    });

                    document.getElementById('call-completed').classList.remove('hidden');
                }
            }, 2000);
        }

        // Mobile interview
        function resetInterview() {
            currentQuestionIndex = 0;
            responses = [];
            updateInterviewDisplay();
        }

        function updateInterviewDisplay() {
            document.getElementById('current-q').textContent = currentQuestionIndex + 1;
            document.getElementById('current-question').textContent = questions[currentQuestionIndex];
            document.getElementById('current-answer').value = '';
            document.getElementById('progress-bar').style.width = ((currentQuestionIndex + 1) / questions.length * 100) + '%';
            document.getElementById('answered-count').textContent = responses.length;
            document.getElementById('next-btn-text').textContent = currentQuestionIndex === questions.length - 1 ? 'é¢æ¥ã‚’å®Œäº†' : 'æ¬¡ã®è³ªå•ã¸';
        }

        function nextQuestion() {
            const answer = document.getElementById('current-answer').value.trim();
            if (!answer) {
                alert('å›ç­”ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            responses.push(answer);

            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                updateInterviewDisplay();
            } else {
                completeInterview();
            }
        }

        function completeInterview() {
            const applicantId = 'APP' + Date.now().toString().slice(-6);
            
            // Update or add applicant
            let applicant = demoData.applicants.find(a => a.status === 'sms_sent');
            if (applicant) {
                applicant.status = 'interview_completed';
                applicant.interview_responses = responses;
                applicant.interview_completed_at = new Date().toISOString();
            } else {
                demoData.applicants.push({
                    id: applicantId,
                    name: 'ãƒ‡ãƒ¢å¿œå‹Ÿè€…',
                    phone: '090-1234-5678',
                    status: 'interview_completed',
                    created_at: new Date().toISOString(),
                    interview_completed_at: new Date().toISOString(),
                    interview_responses: responses,
                    sms_count: 1
                });
            }

            document.getElementById('applicant-id').textContent = applicant ? applicant.id : applicantId;
            document.getElementById('mobile-interview').classList.add('hidden');
            document.getElementById('mobile-completed').classList.remove('hidden');
        }

        // Admin dashboard
        function updateAdminDashboard() {
            const totalCount = demoData.applicants.length;
            const smsCount = demoData.applicants.filter(a => a.sms_count > 0).length;
            const interviewCount = demoData.applicants.filter(a => a.interview_responses && a.interview_responses.length > 0).length;
            const completedCount = demoData.applicants.filter(a => a.status === 'interview_completed').length;

            document.getElementById('total-count').textContent = totalCount;
            document.getElementById('sms-count').textContent = smsCount;
            document.getElementById('interview-count').textContent = interviewCount;
            document.getElementById('completed-count').textContent = completedCount;

            // Update applicants list
            const listContainer = document.getElementById('applicants-list');
            if (demoData.applicants.length === 0) {
                listContainer.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <div class="text-4xl mb-4">ğŸ“</div>
                        <p>ã¾ã å¿œå‹Ÿè€…ãŒã„ã¾ã›ã‚“</p>
                        <p class="text-sm">é›»è©±å—ä»˜ã¾ãŸã¯QRã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ‡ãƒ¢ã‚’é–‹å§‹ã—ã¦ãã ã•ã„</p>
                    </div>
                `;
            } else {
                listContainer.innerHTML = demoData.applicants.map(applicant => {
                    const statusBadge = getStatusBadge(applicant.status);
                    const responseCount = applicant.interview_responses ? applicant.interview_responses.length : 0;
                    
                    return `
                        <div class="border rounded-lg p-4 mb-4">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h4 class="font-semibold">${applicant.name}</h4>
                                    <p class="text-sm text-gray-600">${applicant.phone}</p>
                                    <p class="text-xs text-gray-500">
                                        ID: ${applicant.id} | å—ä»˜: ${new Date(applicant.created_at).toLocaleString('ja-JP')}
                                    </p>
                                </div>
                                <div class="text-right">
                                    ${statusBadge}
                                    <div class="mt-2 text-xs text-gray-500">
                                        <div>SMS: ${applicant.sms_count || 0}ä»¶</div>
                                        <div>é¢æ¥: ${responseCount}å•å›ç­”</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function getStatusBadge(status) {
            switch (status) {
                case 'sms_sent':
                    return '<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">SMSé€ä¿¡æ¸ˆã¿</span>';
                case 'interview_completed':
                    return '<span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">é¢æ¥å®Œäº†</span>';
                default:
                    return '<span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full">æ–°è¦</span>';
            }
        }

        function refreshData() {
            updateAdminDashboard();
        }

        function clearDemoData() {
            if (confirm('ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
                demoData.applicants = [];
                updateAdminDashboard();
            }
        }

        // URL hash navigation
        function handleHashChange() {
            const hash = window.location.hash.slice(1);
            switch (hash) {
                case 'admin':
                    showAdminScreen();
                    break;
                case 'phone':
                    showPhoneScreen();
                    break;
                case 'mobile':
                    showMobileScreen();
                    break;
                default:
                    showHomeScreen();
            }
        }

        // Initialize
        window.addEventListener('hashchange', handleHashChange);
        window.addEventListener('load', () => {
            handleHashChange();
            if (window.location.hash === '' || window.location.hash === '#') {
                showHomeScreen();
            }
        });

        // Update admin dashboard periodically
        setInterval(() => {
            if (!document.getElementById('admin-screen').classList.contains('hidden')) {
                updateAdminDashboard();
            }
        }, 5000);
    </script>
</body>
</html>