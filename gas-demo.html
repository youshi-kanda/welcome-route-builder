<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Apps Script é€£æºãƒ‡ãƒ¢ - ALSOK Interview System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        alsok: {
                            blue: '#0066CC',
                            red: '#E60012',
                            gray: '#666666'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .demo-card {
            transition: all 0.3s ease;
        }
        
        .demo-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-success { background-color: #10B981; }
        .status-pending { background-color: #6B7280; }
        .status-error { background-color: #EF4444; }
        .status-sending { 
            background-color: #F59E0B; 
            animation: pulse 2s infinite;
        }
        
        .log-entry {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            padding: 0.5rem;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid transparent;
        }
        
        .log-success { 
            background-color: #dcfce7; 
            color: #166534; 
            border-left-color: #10b981;
        }
        .log-error { 
            background-color: #fee2e2; 
            color: #991b1b;
            border-left-color: #ef4444; 
        }
        .log-info { 
            background-color: #dbeafe; 
            color: #1d4ed8;
            border-left-color: #3b82f6; 
        }
        .log-warning { 
            background-color: #fef3c7; 
            color: #92400e;
            border-left-color: #f59e0b; 
        }
        
        .progress-bar {
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-2xl font-bold text-alsok-blue">Google Apps Script é€£æºãƒ‡ãƒ¢</h1>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <span class="status-dot" id="connectionStatus"></span>
                        <span id="connectionText" class="text-sm font-medium">æ¥ç¶šç¢ºèªä¸­...</span>
                    </div>
                    <button id="refreshBtn" class="text-sm bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded">
                        ğŸ”„ æ›´æ–°
                    </button>
                </div>
            </div>
            <p class="text-gray-600">ALSOKé¢æ¥ã‚·ã‚¹ãƒ†ãƒ ã¨Google Apps Script (GAS)ã®é€£æºã‚’ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ¢ã—ã¾ã™ã€‚</p>
        </div>

        <!-- Quick Status -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-lg shadow p-4 text-center">
                <div class="text-2xl mb-2">ğŸ”Œ</div>
                <div class="text-sm text-gray-600">GASæ¥ç¶š</div>
                <div id="quickStatus1" class="font-medium text-gray-800">ç¢ºèªä¸­...</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4 text-center">
                <div class="text-2xl mb-2">ğŸ“Š</div>
                <div class="text-sm text-gray-600">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</div>
                <div id="quickStatus2" class="font-medium text-gray-800">æº–å‚™ä¸­...</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4 text-center">
                <div class="text-2xl mb-2">ğŸ“¤</div>
                <div class="text-sm text-gray-600">ãƒ‡ãƒ¼ã‚¿é€ä¿¡</div>
                <div id="quickStatus3" class="font-medium text-gray-800">å¾…æ©Ÿä¸­</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4 text-center">
                <div class="text-2xl mb-2">ğŸ“ˆ</div>
                <div class="text-sm text-gray-600">æˆåŠŸç‡</div>
                <div id="quickStatus4" class="font-medium text-gray-800">0%</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Demo Actions -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸ§ª ãƒ‡ãƒ¢ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h2>
                
                <div class="space-y-4">
                    <!-- æ¥ç¶šãƒ†ã‚¹ãƒˆ -->
                    <div class="demo-card border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">1. æ¥ç¶šãƒ†ã‚¹ãƒˆ</h3>
                            <span class="status-dot status-pending" id="testStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">GAS Web Appã¨ã®æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™</p>
                        <button id="testConnectionBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md transition-colors">
                            ğŸ”Œ æ¥ç¶šãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                        </button>
                    </div>

                    <!-- å˜ä½“ãƒ‡ãƒ¼ã‚¿é€ä¿¡ -->
                    <div class="demo-card border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">2. å˜ä½“ãƒ‡ãƒ¼ã‚¿é€ä¿¡</h3>
                            <span class="status-dot status-pending" id="singleStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">1ä»¶ã®æ¨¡æ“¬å¿œå‹Ÿè€…ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã™</p>
                        <button id="sendSingleBtn" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition-colors" disabled>
                            ğŸ“¤ å˜ä½“ãƒ‡ãƒ¼ã‚¿é€ä¿¡
                        </button>
                    </div>

                    <!-- è¤‡æ•°ãƒ‡ãƒ¼ã‚¿é€ä¿¡ -->
                    <div class="demo-card border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">3. è¤‡æ•°ãƒ‡ãƒ¼ã‚¿é€ä¿¡</h3>
                            <span class="status-dot status-pending" id="batchStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">è¤‡æ•°ã®æ¨¡æ“¬å¿œå‹Ÿè€…ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬é€ä¿¡ã—ã¾ã™</p>
                        <div class="flex space-x-2 mb-3">
                            <select id="batchCount" class="flex-1 px-3 py-2 border rounded-md">
                                <option value="3">3ä»¶</option>
                                <option value="5">5ä»¶</option>
                                <option value="10">10ä»¶</option>
                            </select>
                            <button id="sendBatchBtn" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition-colors" disabled>
                                ğŸ“Š ä¸€æ‹¬é€ä¿¡
                            </button>
                        </div>
                        <div class="bg-gray-100 rounded-lg p-2">
                            <div class="flex justify-between text-xs text-gray-600 mb-1">
                                <span>é€²è¡ŒçŠ¶æ³</span>
                                <span id="progressText">0/0</span>
                            </div>
                            <div class="bg-gray-300 rounded-full h-2">
                                <div id="progressBar" class="progress-bar bg-purple-600 h-2 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç¢ºèª -->
                    <div class="demo-card border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">4. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç¢ºèª</h3>
                            <span class="status-dot status-pending" id="viewStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">é€ä¿¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ç¢ºèªã—ã¾ã™</p>
                        <button id="viewSpreadsheetBtn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-2 px-4 rounded-md transition-colors" disabled>
                            ğŸ“‹ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã
                        </button>
                    </div>
                </div>

                <!-- Settings Quick Access -->
                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                    <h3 class="font-medium text-blue-800 mb-2">âš™ï¸ è¨­å®š</h3>
                    <div class="space-y-2">
                        <button id="openSettingsBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded text-sm">
                            GASè¨­å®šãƒšãƒ¼ã‚¸ã‚’é–‹ã
                        </button>
                        <div class="text-xs text-blue-600" id="currentUrl">
                            URL: æœªè¨­å®š
                        </div>
                    </div>
                </div>
            </div>

            <!-- Log Output -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-800">ğŸ“‹ å®Ÿè¡Œãƒ­ã‚°</h2>
                    <div class="space-x-2">
                        <button id="clearLogBtn" class="text-sm text-gray-500 hover:text-gray-700">
                            ğŸ—‘ï¸ ã‚¯ãƒªã‚¢
                        </button>
                        <button id="exportLogBtn" class="text-sm bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded">
                            ğŸ“ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                        </button>
                    </div>
                </div>
                
                <div id="logOutput" class="bg-gray-50 rounded-lg p-4 h-96 overflow-y-auto">
                    <div class="log-entry log-info">ğŸš€ GASé€£æºãƒ‡ãƒ¢ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•</div>
                </div>
            </div>
        </div>

        <!-- Sample Data Preview -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸ“„ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
            
            <div class="overflow-x-auto">
                <table class="min-w-full table-auto">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">å¿œå‹Ÿè€…å</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">é›»è©±ç•ªå·</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">å¹´é½¢ç¢ºèª</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">å›½ç±ç¢ºèª</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-600">ç·åˆçµæœ</th>
                        </tr>
                    </thead>
                    <tbody id="sampleDataTable" class="bg-white divide-y divide-gray-200">
                        <!-- å‹•çš„ã«ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
            
            <div class="mt-4 text-xs text-gray-500">
                ğŸ’¡ ä¸Šè¨˜ã¯ãƒ‡ãƒ¢é€ä¿¡æ™‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚å®Ÿéš›ã«ã¯27åˆ—ã®ãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚
            </div>
        </div>

        <!-- Statistics -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">ğŸ“Š é€ä¿¡çµ±è¨ˆ</h2>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="text-center">
                    <div class="text-2xl font-bold text-blue-600" id="statTotal">0</div>
                    <div class="text-sm text-gray-600">ç·é€ä¿¡æ•°</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-green-600" id="statSuccess">0</div>
                    <div class="text-sm text-gray-600">æˆåŠŸæ•°</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-red-600" id="statError">0</div>
                    <div class="text-sm text-gray-600">ã‚¨ãƒ©ãƒ¼æ•°</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-purple-600" id="statRate">0%</div>
                    <div class="text-sm text-gray-600">æˆåŠŸç‡</div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="mt-6 text-center space-x-4">
            <a href="admin-dashboard.html" class="inline-flex items-center text-alsok-blue hover:text-alsok-red">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                ç®¡ç†ç”»é¢ã«æˆ»ã‚‹
            </a>
            <span class="text-gray-400">|</span>
            <a href="gas-setup.html" class="text-alsok-blue hover:text-alsok-red">
                GASè¨­å®šãƒšãƒ¼ã‚¸
            </a>
        </div>
    </div>

    <!-- Scripts -->
    <script src="gas-integration.js"></script>
    <script>
        class GASDemo {
            constructor() {
                this.gasIntegration = null;
                this.stats = {
                    total: 0,
                    success: 0,
                    error: 0
                };
                
                this.initializeUI();
                this.bindEvents();
                this.startInitialization();
            }

            initializeUI() {
                this.logOutput = document.getElementById('logOutput');
                this.updateConnectionStatus('pending');
                this.generateSampleDataTable();
                this.updateStatistics();
            }

            bindEvents() {
                // Demo action buttons
                document.getElementById('testConnectionBtn').addEventListener('click', () => this.testConnection());
                document.getElementById('sendSingleBtn').addEventListener('click', () => this.sendSingleData());
                document.getElementById('sendBatchBtn').addEventListener('click', () => this.sendBatchData());
                document.getElementById('viewSpreadsheetBtn').addEventListener('click', () => this.viewSpreadsheet());
                
                // Utility buttons
                document.getElementById('refreshBtn').addEventListener('click', () => this.refresh());
                document.getElementById('clearLogBtn').addEventListener('click', () => this.clearLog());
                document.getElementById('exportLogBtn').addEventListener('click', () => this.exportLog());
                document.getElementById('openSettingsBtn').addEventListener('click', () => this.openSettings());
                
                // Connection status listener
                document.addEventListener('gasConnectionStatus', (e) => {
                    this.updateConnectionStatus(e.detail.status);
                });
            }

            async startInitialization() {
                this.log('ğŸš€ GASé€£æºãƒ‡ãƒ¢ã‚’åˆæœŸåŒ–ä¸­...', 'info');
                
                try {
                    this.gasIntegration = initializeGASIntegration();
                    const status = this.gasIntegration.getStatus();
                    
                    this.log(`ğŸ“Š GASè¨­å®šçŠ¶æ³: æœ‰åŠ¹=${status.isEnabled}, URL=${status.hasUrl}`, 'info');
                    
                    if (status.hasUrl) {
                        document.getElementById('currentUrl').textContent = `URL: ${status.url}`;
                        this.updateQuickStatus();
                        
                        if (status.isEnabled) {
                            this.enableButtons();
                            this.updateConnectionStatus('connected');
                            this.log('âœ… GASé€£æºæº–å‚™å®Œäº†', 'success');
                        } else {
                            this.updateConnectionStatus('disconnected');
                            this.log('âš ï¸ GASé€£æºãŒç„¡åŠ¹ã§ã™', 'warning');
                        }
                    } else {
                        this.updateConnectionStatus('disconnected');
                        this.log('âŒ GAS Web App URLãŒæœªè¨­å®šã§ã™', 'error');
                    }
                    
                } catch (error) {
                    this.log('âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.updateConnectionStatus('error');
                }
            }

            async testConnection() {
                this.log('ğŸ”Œ æ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
                this.updateStatusDot('testStatus', 'sending');
                
                try {
                    const result = await testGASConnection();
                    
                    if (result.success) {
                        this.log('âœ… æ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸ: ' + result.message, 'success');
                        this.updateStatusDot('testStatus', 'success');
                        this.updateConnectionStatus('connected');
                        this.enableButtons();
                        this.updateQuickStatus();
                    } else {
                        this.log('âŒ æ¥ç¶šãƒ†ã‚¹ãƒˆå¤±æ•—: ' + result.message, 'error');
                        this.updateStatusDot('testStatus', 'error');
                        this.updateConnectionStatus('error');
                    }
                } catch (error) {
                    this.log('âŒ æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.updateStatusDot('testStatus', 'error');
                    this.updateConnectionStatus('error');
                }
            }

            async sendSingleData() {
                this.log('ğŸ“¤ å˜ä½“ãƒ‡ãƒ¼ã‚¿é€ä¿¡é–‹å§‹...', 'info');
                this.updateStatusDot('singleStatus', 'sending');
                
                try {
                    const results = await this.gasIntegration.sendDemoData(1);
                    this.stats.total++;
                    
                    if (results[0].success) {
                        this.stats.success++;
                        this.log('âœ… å˜ä½“ãƒ‡ãƒ¼ã‚¿é€ä¿¡æˆåŠŸ', 'success');
                        this.updateStatusDot('singleStatus', 'success');
                        
                        if (results[0].response?.spreadsheetUrl) {
                            document.getElementById('viewSpreadsheetBtn').disabled = false;
                            this.log(`ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURL: ${results[0].response.spreadsheetUrl}`, 'info');
                        }
                    } else {
                        this.stats.error++;
                        this.log('âŒ å˜ä½“ãƒ‡ãƒ¼ã‚¿é€ä¿¡å¤±æ•—: ' + results[0].message, 'error');
                        this.updateStatusDot('singleStatus', 'error');
                    }
                } catch (error) {
                    this.stats.error++;
                    this.log('âŒ é€ä¿¡ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.updateStatusDot('singleStatus', 'error');
                }
                
                this.updateStatistics();
                this.updateQuickStatus();
            }

            async sendBatchData() {
                const count = parseInt(document.getElementById('batchCount').value);
                this.log(`ğŸ“Š è¤‡æ•°ãƒ‡ãƒ¼ã‚¿é€ä¿¡é–‹å§‹ (${count}ä»¶)...`, 'info');
                this.updateStatusDot('batchStatus', 'sending');
                
                // Progress bar setup
                const progressBar = document.getElementById('progressBar');
                const progressText = document.getElementById('progressText');
                let successCount = 0;
                
                try {
                    for (let i = 0; i < count; i++) {
                        // Progress update
                        const progress = ((i) / count * 100).toFixed(0);
                        progressBar.style.width = progress + '%';
                        progressText.textContent = `${i}/${count}`;
                        
                        // Send data
                        const results = await this.gasIntegration.sendDemoData(1);
                        this.stats.total++;
                        
                        if (results[0].success) {
                            this.stats.success++;
                            successCount++;
                            this.log(`ğŸ“¤ ãƒ‡ãƒ¼ã‚¿ ${i + 1}/${count} é€ä¿¡å®Œäº†`, 'success');
                        } else {
                            this.stats.error++;
                            this.log(`âŒ ãƒ‡ãƒ¼ã‚¿ ${i + 1}/${count} é€ä¿¡å¤±æ•—: ${results[0].message}`, 'error');
                        }
                        
                        // Short delay between requests
                        if (i < count - 1) {
                            await this.sleep(500);
                        }
                    }
                    
                    // Final progress
                    progressBar.style.width = '100%';
                    progressText.textContent = `${count}/${count}`;
                    
                    this.log(`âœ… è¤‡æ•°ãƒ‡ãƒ¼ã‚¿é€ä¿¡å®Œäº†: ${successCount}/${count}ä»¶æˆåŠŸ`, 'success');
                    this.updateStatusDot('batchStatus', 'success');
                    
                    if (successCount > 0) {
                        document.getElementById('viewSpreadsheetBtn').disabled = false;
                    }
                    
                } catch (error) {
                    this.log('âŒ è¤‡æ•°ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.updateStatusDot('batchStatus', 'error');
                }
                
                this.updateStatistics();
                this.updateQuickStatus();
                
                // Reset progress after delay
                setTimeout(() => {
                    progressBar.style.width = '0%';
                    progressText.textContent = '0/0';
                }, 3000);
            }

            async viewSpreadsheet() {
                const status = this.gasIntegration.getStatus();
                
                if (status.hasUrl) {
                    // Try to get the spreadsheet URL from the last response
                    // For demo purposes, we'll open the GAS setup page
                    this.log('ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç¢ºèªæ©Ÿèƒ½ã¯å®Ÿè£…ä¸­ã§ã™', 'warning');
                    this.log('ğŸ’¡ å®Ÿéš›ã®é‹ç”¨æ™‚ã¯ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãŒç›´æ¥é–‹ãã¾ã™', 'info');
                    this.updateStatusDot('viewStatus', 'success');
                } else {
                    this.log('âŒ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURLãŒåˆ©ç”¨ã§ãã¾ã›ã‚“', 'error');
                    this.updateStatusDot('viewStatus', 'error');
                }
            }

            async refresh() {
                this.log('ğŸ”„ ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’æ›´æ–°ä¸­...', 'info');
                await this.startInitialization();
            }

            enableButtons() {
                document.getElementById('sendSingleBtn').disabled = false;
                document.getElementById('sendBatchBtn').disabled = false;
            }

            updateConnectionStatus(status) {
                const indicator = document.getElementById('connectionStatus');
                const text = document.getElementById('connectionText');
                
                indicator.className = 'status-dot';
                
                let statusText = '';
                switch (status) {
                    case 'connected':
                        indicator.classList.add('status-success');
                        statusText = 'æ¥ç¶šæ¸ˆã¿';
                        break;
                    case 'sending':
                        indicator.classList.add('status-sending');
                        statusText = 'é€ä¿¡ä¸­...';
                        break;
                    case 'error':
                        indicator.classList.add('status-error');
                        statusText = 'ã‚¨ãƒ©ãƒ¼';
                        break;
                    case 'pending':
                    default:
                        indicator.classList.add('status-pending');
                        statusText = 'æœªæ¥ç¶š';
                }
                
                text.textContent = statusText;
            }

            updateStatusDot(elementId, status) {
                const dot = document.getElementById(elementId);
                if (dot) {
                    dot.className = 'status-dot status-' + status;
                }
            }

            updateQuickStatus() {
                const status = this.gasIntegration ? this.gasIntegration.getStatus() : {};
                
                document.getElementById('quickStatus1').textContent = status.isEnabled ? 'æœ‰åŠ¹' : 'ç„¡åŠ¹';
                document.getElementById('quickStatus2').textContent = status.hasUrl ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š';
                document.getElementById('quickStatus3').textContent = this.stats.total > 0 ? 'é€ä¿¡æ¸ˆã¿' : 'å¾…æ©Ÿä¸­';
                
                const rate = this.stats.total > 0 ? (this.stats.success / this.stats.total * 100).toFixed(0) : 0;
                document.getElementById('quickStatus4').textContent = rate + '%';
            }

            updateStatistics() {
                document.getElementById('statTotal').textContent = this.stats.total;
                document.getElementById('statSuccess').textContent = this.stats.success;
                document.getElementById('statError').textContent = this.stats.error;
                
                const rate = this.stats.total > 0 ? (this.stats.success / this.stats.total * 100).toFixed(0) : 0;
                document.getElementById('statRate').textContent = rate + '%';
            }

            generateSampleDataTable() {
                const sampleData = [
                    ['ç”°ä¸­å¤ªéƒï¼ˆãƒ‡ãƒ¢1ï¼‰', '090-DEMO-1001', '18æ­³ä»¥ä¸Šã§ã™', 'æ—¥æœ¬å›½ç±ã§ã™', 'é¢æ¥å®Ÿæ–½äºˆå®š'],
                    ['ä½è—¤èŠ±å­ï¼ˆãƒ‡ãƒ¢2ï¼‰', '090-DEMO-1002', '18æ­³ä»¥ä¸Šã§ã™', 'æ—¥æœ¬å›½ç±ã§ã™', 'é¢æ¥å®Ÿæ–½äºˆå®š'],
                    ['éˆ´æœ¨ä¸€éƒï¼ˆãƒ‡ãƒ¢3ï¼‰', '090-DEMO-1003', '18æ­³ä»¥ä¸Šã§ã™', 'æ—¥æœ¬å›½ç±ã§ã™', 'é¢æ¥å®Ÿæ–½äºˆå®š']
                ];
                
                const tableBody = document.getElementById('sampleDataTable');
                tableBody.innerHTML = '';
                
                sampleData.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = row.map(cell => `<td class="px-4 py-2 text-sm text-gray-900">${cell}</td>`).join('');
                    tableBody.appendChild(tr);
                });
            }

            log(message, type = 'info') {
                const timestamp = new Date().toLocaleTimeString('ja-JP');
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${type}`;
                logEntry.textContent = `[${timestamp}] ${message}`;
                
                this.logOutput.appendChild(logEntry);
                this.logOutput.scrollTop = this.logOutput.scrollHeight;
            }

            clearLog() {
                this.logOutput.innerHTML = '<div class="log-entry log-info">ğŸ—‘ï¸ ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ</div>';
            }

            exportLog() {
                const logs = Array.from(this.logOutput.children).map(entry => entry.textContent).join('\n');
                const blob = new Blob([logs], { type: 'text/plain;charset=utf-8' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `gas-demo-log-${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                this.log('ğŸ“ ãƒ­ã‚°ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
            }

            openSettings() {
                window.open('gas-setup.html', '_blank');
                this.log('ğŸ“ GASè¨­å®šãƒšãƒ¼ã‚¸ã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãã¾ã—ãŸ', 'info');
            }

            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // Initialize demo when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new GASDemo();
        });
    </script>
</body>
</html>