<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Integration Demo - ALSOK Interview System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        alsok: {
                            blue: '#0066CC',
                            red: '#E60012',
                            gray: '#666666'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .demo-step {
            transition: all 0.3s ease;
        }
        
        .demo-step:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-success { background-color: #10B981; }
        .status-pending { background-color: #6B7280; }
        .status-demo { background-color: #F59E0B; }
        .status-error { background-color: #EF4444; }
        
        .log-entry {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            padding: 0.5rem;
            border-radius: 0.375rem;
            margin-bottom: 0.5rem;
        }
        
        .log-success { background-color: #dcfce7; color: #166534; }
        .log-error { background-color: #fee2e2; color: #991b1b; }
        .log-info { background-color: #dbeafe; color: #1d4ed8; }
        .log-warning { background-color: #fef3c7; color: #92400e; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h1 class="text-2xl font-bold text-alsok-blue">Google Sheets çµ±åˆãƒ‡ãƒ¢</h1>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <span class="status-dot" id="connectionStatus"></span>
                        <span id="connectionText" class="text-sm font-medium">æ¥ç¶šç¢ºèªä¸­...</span>
                    </div>
                    <button id="refreshConnectionBtn" class="text-sm bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded">
                        æ›´æ–°
                    </button>
                </div>
            </div>
            <p class="text-gray-600">ALSOKé¢æ¥ã‚·ã‚¹ãƒ†ãƒ ã¨Google Spreadsheetsã®é€£æºã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Demo Actions -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-bold mb-4 text-gray-800">ãƒ‡ãƒ¢ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h2>
                
                <div class="space-y-4">
                    <!-- æ¥ç¶šãƒ†ã‚¹ãƒˆ -->
                    <div class="demo-step border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">1. æ¥ç¶šãƒ†ã‚¹ãƒˆ</h3>
                            <span class="status-dot status-pending" id="testStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">Google Sheets APIã¨ã®æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™</p>
                        <button id="testConnectionBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md transition-colors">
                            æ¥ç¶šãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                        </button>
                    </div>

                    <!-- ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é€ä¿¡ -->
                    <div class="demo-step border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">2. ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é€ä¿¡</h3>
                            <span class="status-dot status-pending" id="sendStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">æ¨¡æ“¬å¿œå‹Ÿè€…ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«é€ä¿¡ã—ã¾ã™</p>
                        <button id="sendSampleDataBtn" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition-colors" disabled>
                            ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é€ä¿¡
                        </button>
                    </div>

                    <!-- è¤‡æ•°ãƒ‡ãƒ¼ã‚¿é€ä¿¡ -->
                    <div class="demo-step border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">3. è¤‡æ•°ãƒ‡ãƒ¼ã‚¿é€ä¿¡</h3>
                            <span class="status-dot status-pending" id="batchStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">è¤‡æ•°ã®å¿œå‹Ÿè€…ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬é€ä¿¡ã—ã¾ã™</p>
                        <div class="flex space-x-2">
                            <input type="number" id="batchCount" class="flex-1 px-3 py-2 border rounded-md" placeholder="é€ä¿¡æ•°" min="1" max="10" value="3">
                            <button id="sendBatchDataBtn" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md transition-colors" disabled>
                                ä¸€æ‹¬é€ä¿¡
                            </button>
                        </div>
                    </div>

                    <!-- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç¢ºèª -->
                    <div class="demo-step border rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="font-semibold text-gray-800">4. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç¢ºèª</h3>
                            <span class="status-dot status-pending" id="viewStatus"></span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">é€ä¿¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã§ç¢ºèªã—ã¾ã™</p>
                        <button id="viewSheetBtn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-2 px-4 rounded-md transition-colors" disabled>
                            ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’é–‹ã
                        </button>
                    </div>
                </div>

                <!-- Demo Data Preview -->
                <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="font-medium text-gray-800 mb-2">é€ä¿¡äºˆå®šãƒ‡ãƒ¼ã‚¿ä¾‹</h3>
                    <div class="text-xs text-gray-600 space-y-1" id="sampleDataPreview">
                        <!-- å‹•çš„ã«ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- Log Output -->
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-bold text-gray-800">å®Ÿè¡Œãƒ­ã‚°</h2>
                    <button id="clearLogBtn" class="text-sm text-gray-500 hover:text-gray-700">
                        ã‚¯ãƒªã‚¢
                    </button>
                </div>
                
                <div id="logOutput" class="bg-gray-50 rounded-lg p-4 h-80 overflow-y-auto">
                    <div class="log-entry log-info">ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­...</div>
                </div>
            </div>
        </div>

        <!-- Configuration Panel -->
        <div class="bg-white rounded-lg shadow-md p-6 mt-6">
            <h2 class="text-xl font-bold mb-4 text-gray-800">è¨­å®šæƒ…å ±</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-medium text-gray-800 mb-2">ç¾åœ¨ã®è¨­å®š</h3>
                    <div class="bg-gray-50 rounded-lg p-3 text-sm space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-600">APIæ¥ç¶š:</span>
                            <span id="configApiStatus">æœªç¢ºèª</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ:</span>
                            <span id="configSheetStatus">æœªè¨­å®š</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ãƒ¢ãƒ¼ãƒ‰:</span>
                            <span id="configMode">ãƒ‡ãƒ¢</span>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="font-medium text-gray-800 mb-2">ã‚¯ã‚¤ãƒƒã‚¯è¨­å®š</h3>
                    <div class="space-y-2">
                        <button id="setupDemoModeBtn" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-2 px-4 rounded-md text-sm">
                            ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰è¨­å®š
                        </button>
                        <button id="openSetupPageBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-md text-sm">
                            è©³ç´°è¨­å®šãƒšãƒ¼ã‚¸ã‚’é–‹ã
                        </button>
                        <button id="exportTemplateBtn" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-md text-sm">
                            ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="mt-6 text-center space-x-4">
            <a href="admin-dashboard.html" class="inline-flex items-center text-alsok-blue hover:text-alsok-red">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                ç®¡ç†ç”»é¢ã«æˆ»ã‚‹
            </a>
            <span class="text-gray-400">|</span>
            <a href="google-sheets-setup.html" class="text-alsok-blue hover:text-alsok-red">
                è¨­å®šãƒšãƒ¼ã‚¸
            </a>
        </div>
    </div>

    <!-- Scripts -->
    <script src="shared-storage.js"></script>
    <script src="google-sheets-config.js"></script>
    <script src="google-sheets-api.js"></script>
    <script>
        class GoogleSheetsDemo {
            constructor() {
                this.isInitialized = false;
                this.sheetsAPI = null;
                
                this.initializeUI();
                this.bindEvents();
                this.startInitialization();
            }

            initializeUI() {
                this.logOutput = document.getElementById('logOutput');
                this.connectionStatus = document.getElementById('connectionStatus');
                this.connectionText = document.getElementById('connectionText');
                
                // Status dots
                this.testStatus = document.getElementById('testStatus');
                this.sendStatus = document.getElementById('sendStatus');
                this.batchStatus = document.getElementById('batchStatus');
                this.viewStatus = document.getElementById('viewStatus');
                
                // Buttons
                this.testConnectionBtn = document.getElementById('testConnectionBtn');
                this.sendSampleDataBtn = document.getElementById('sendSampleDataBtn');
                this.sendBatchDataBtn = document.getElementById('sendBatchDataBtn');
                this.viewSheetBtn = document.getElementById('viewSheetBtn');
                
                this.generateSampleDataPreview();
            }

            bindEvents() {
                // Demo action buttons
                this.testConnectionBtn.addEventListener('click', () => this.testConnection());
                this.sendSampleDataBtn.addEventListener('click', () => this.sendSampleData());
                this.sendBatchDataBtn.addEventListener('click', () => this.sendBatchData());
                this.viewSheetBtn.addEventListener('click', () => this.viewSpreadsheet());
                
                // Control buttons
                document.getElementById('refreshConnectionBtn').addEventListener('click', () => this.refreshConnection());
                document.getElementById('clearLogBtn').addEventListener('click', () => this.clearLog());
                document.getElementById('setupDemoModeBtn').addEventListener('click', () => this.setupDemoMode());
                document.getElementById('openSetupPageBtn').addEventListener('click', () => this.openSetupPage());
                document.getElementById('exportTemplateBtn').addEventListener('click', () => this.exportTemplate());
                
                // Connection status listener
                document.addEventListener('sheetsConnectionStatus', (e) => {
                    this.updateConnectionDisplay(e.detail);
                });
            }

            async startInitialization() {
                this.log('ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã‚’é–‹å§‹ã—ã¾ã™...', 'info');
                
                try {
                    const result = await initializeGoogleSheets();
                    this.isInitialized = result.success || result.message?.includes('ãƒ‡ãƒ¢');
                    
                    if (this.isInitialized) {
                        this.log('âœ… åˆæœŸåŒ–å®Œäº†: ' + result.message, 'success');
                        this.enableButtons();
                    } else {
                        this.log('âš ï¸ åˆæœŸåŒ–è­¦å‘Š: ' + result.message, 'warning');
                        this.setupDemoMode();
                    }
                    
                    this.updateConnectionDisplay({ status: result.success ? 'connected' : 'demo_mode' });
                    this.updateConfigDisplay();
                } catch (error) {
                    this.log('âŒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.updateConnectionDisplay({ status: 'error' });
                }
            }

            async testConnection() {
                this.log('æ¥ç¶šãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­...', 'info');
                this.testStatus.className = 'status-dot status-pending';
                
                try {
                    const result = await initializeGoogleSheets();
                    
                    if (result.success) {
                        this.log('âœ… æ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸ: ' + result.message, 'success');
                        this.testStatus.className = 'status-dot status-success';
                        this.enableButtons();
                    } else {
                        this.log('âš ï¸ æ¥ç¶šãƒ†ã‚¹ãƒˆ (ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰): ' + result.message, 'warning');
                        this.testStatus.className = 'status-dot status-demo';
                        this.enableButtons();
                    }
                } catch (error) {
                    this.log('âŒ æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.testStatus.className = 'status-dot status-error';
                }
            }

            async sendSampleData() {
                this.log('ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã‚’é–‹å§‹...', 'info');
                this.sendStatus.className = 'status-dot status-pending';
                
                try {
                    const sampleData = this.generateSampleApplicantData();
                    const result = await submitToGoogleSheets(sampleData);
                    
                    if (result.success) {
                        this.log('âœ… ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é€ä¿¡æˆåŠŸ', 'success');
                        this.sendStatus.className = 'status-dot status-success';
                        this.viewSheetBtn.disabled = false;
                        
                        if (result.sheetUrl) {
                            this.log('ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURL: ' + result.sheetUrl, 'info');
                        }
                    } else {
                        this.log('âš ï¸ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é€ä¿¡ (ãƒ‡ãƒ¢): ' + result.message, 'warning');
                        this.sendStatus.className = 'status-dot status-demo';
                    }
                } catch (error) {
                    this.log('âŒ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.sendStatus.className = 'status-dot status-error';
                }
            }

            async sendBatchData() {
                const count = parseInt(document.getElementById('batchCount').value) || 3;
                this.log(`ä¸€æ‹¬ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã‚’é–‹å§‹ (${count}ä»¶)...`, 'info');
                this.batchStatus.className = 'status-dot status-pending';
                
                try {
                    let successCount = 0;
                    
                    for (let i = 0; i < count; i++) {
                        const sampleData = this.generateSampleApplicantData(i + 1);
                        const result = await submitToGoogleSheets(sampleData);
                        
                        if (result.success || result.demo) {
                            successCount++;
                            this.log(`ğŸ“¤ ãƒ‡ãƒ¼ã‚¿ ${i + 1}/${count} é€ä¿¡å®Œäº†`, 'success');
                        } else {
                            this.log(`âŒ ãƒ‡ãƒ¼ã‚¿ ${i + 1}/${count} é€ä¿¡å¤±æ•—: ${result.message}`, 'error');
                        }
                        
                        // çŸ­ã„é–“éš”ã§é€ä¿¡
                        if (i < count - 1) {
                            await new Promise(resolve => setTimeout(resolve, 500));
                        }
                    }
                    
                    this.log(`âœ… ä¸€æ‹¬é€ä¿¡å®Œäº†: ${successCount}/${count}ä»¶æˆåŠŸ`, 'success');
                    this.batchStatus.className = 'status-dot status-success';
                    this.viewSheetBtn.disabled = false;
                } catch (error) {
                    this.log('âŒ ä¸€æ‹¬é€ä¿¡ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                    this.batchStatus.className = 'status-dot status-error';
                }
            }

            viewSpreadsheet() {
                const status = getGoogleSheetsStatus();
                
                if (status.hasCredentials && googleSheetsAPI?.getSheetUrl()) {
                    const url = googleSheetsAPI.getSheetUrl();
                    window.open(url, '_blank');
                    this.log('ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãã¾ã—ãŸ', 'info');
                    this.viewStatus.className = 'status-dot status-success';
                } else {
                    this.log('âš ï¸ ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ - ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURLãŒåˆ©ç”¨ã§ãã¾ã›ã‚“', 'warning');
                    this.viewStatus.className = 'status-dot status-demo';
                }
            }

            generateSampleApplicantData(index = 1) {
                const names = ['ç”°ä¸­å¤ªéƒ', 'ä½è—¤èŠ±å­', 'éˆ´æœ¨ä¸€éƒ', 'é«˜æ©‹ç¾å’²', 'æ¸¡è¾ºå¥å¤ª'];
                const name = names[(index - 1) % names.length];
                
                return {
                    applicantName: name,
                    phoneNumber: `090-1234-${String(5670 + index).padStart(4, '0')}`,
                    applicationSource: 'ãƒ‡ãƒ¢å¿œå‹Ÿ',
                    step1_answer: '18æ­³ä»¥ä¸Šã§ã™',
                    step2_answer: 'æ—¥æœ¬å›½ç±ã§ã™',
                    step3_answer: 'ã‚ã‚Šã¾ã›ã‚“',
                    step4_answer: 'ã‚ã‚Šã¾ã›ã‚“',
                    step5_answer: 'ã‚ã‚Šã¾ã›ã‚“',
                    step6_answer: 'ã‚ã‚Šã¾ã›ã‚“',
                    step7_answer: 'ã‚ã‚Šã¾ã›ã‚“',
                    step8_answer: 'æ±äº¬éƒ½å†…åœ¨ä½',
                    step9_answer: 'æä¾›ã—ãŸç•ªå·ã§é€£çµ¡å¯èƒ½',
                    step10_answer: 'ã¯ã„ã€å¸Œæœ›ã—ã¾ã™',
                    step11_answer: 'ç‰¹ã«ã‚ã‚Šã¾ã›ã‚“',
                    disqualificationStatus: 'é©æ ¼',
                    overallResult: 'é¢æ¥å®Ÿæ–½äºˆå®š',
                    completionTime: new Date().toLocaleString('ja-JP'),
                    sessionId: `demo_session_${index}_${Date.now()}`,
                    notes: `ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ #${index}`
                };
            }

            generateSampleDataPreview() {
                const sampleData = this.generateSampleApplicantData();
                const preview = document.getElementById('sampleDataPreview');
                
                preview.innerHTML = `
                    <div><strong>å¿œå‹Ÿè€…å:</strong> ${sampleData.applicantName}</div>
                    <div><strong>é›»è©±ç•ªå·:</strong> ${sampleData.phoneNumber}</div>
                    <div><strong>å¹´é½¢ç¢ºèª:</strong> ${sampleData.step1_answer}</div>
                    <div><strong>å›½ç±ç¢ºèª:</strong> ${sampleData.step2_answer}</div>
                    <div><strong>ç·åˆçµæœ:</strong> ${sampleData.overallResult}</div>
                    <div class="text-gray-500 mt-1">... ä»–22é …ç›®</div>
                `;
            }

            setupDemoMode() {
                this.log('ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰è¨­å®šã‚’å®Ÿè¡Œä¸­...', 'info');
                
                const demoConfig = googleSheetsConfig.getDemoConfig();
                googleSheetsConfig.saveConfig(demoConfig);
                
                this.log('âœ… ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰è¨­å®šå®Œäº†', 'success');
                this.updateConnectionDisplay({ status: 'demo_mode' });
                this.updateConfigDisplay();
                this.enableButtons();
            }

            openSetupPage() {
                window.open('google-sheets-setup.html', '_blank');
                this.log('ğŸ“ è¨­å®šãƒšãƒ¼ã‚¸ã‚’æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ãã¾ã—ãŸ', 'info');
            }

            exportTemplate() {
                const headers = [
                    'å¿œå‹Ÿæ—¥æ™‚', 'å¿œå‹Ÿè€…å', 'é›»è©±ç•ªå·', 'å¿œå‹ŸçµŒè·¯', 'å¹´é½¢ç¢ºèª', 'å›½ç±ç¢ºèª',
                    'éå»ã®é€®æ•æ­´', 'æš´åŠ›å›£é–¢ä¿‚', 'ç²¾ç¥çš„ãªç—…æ°—', 'ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ä¾å­˜ç—‡', 'è–¬ç‰©ä¾å­˜ç—‡',
                    'ä½å±…ç¢ºèª', 'é€£çµ¡å…ˆç¢ºèª', 'é¢æ¥å¸Œæœ›', 'ç‰¹è¨˜äº‹é …', 'å¤±æ ¼çŠ¶æ³', 'ç·åˆçµæœ',
                    'å®Œäº†æ™‚é–“', 'ãƒ‡ãƒã‚¤ã‚¹ç¨®åˆ¥', 'IPã‚¢ãƒ‰ãƒ¬ã‚¹', 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ', 'ã‚»ãƒƒã‚·ãƒ§ãƒ³ID',
                    'ãƒªãƒ•ã‚¡ãƒ©ãƒ¼', 'ç”»é¢è§£åƒåº¦', 'è¨€èªè¨­å®š', 'ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³', 'å‚™è€ƒ'
                ];
                
                const csv = '\uFEFF' + headers.join(',') + '\n';
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'ALSOK_ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                this.log('ğŸ“ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ', 'success');
            }

            async refreshConnection() {
                this.log('æ¥ç¶šçŠ¶æ³ã‚’æ›´æ–°ä¸­...', 'info');
                await this.startInitialization();
            }

            enableButtons() {
                this.sendSampleDataBtn.disabled = false;
                this.sendBatchDataBtn.disabled = false;
            }

            updateConnectionDisplay(detail) {
                let statusClass = '';
                let statusText = '';
                
                switch (detail.status) {
                    case 'connected':
                        statusClass = 'status-success';
                        statusText = 'æ¥ç¶šæ¸ˆã¿';
                        break;
                    case 'demo_mode':
                        statusClass = 'status-demo';
                        statusText = 'ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰';
                        break;
                    case 'error':
                        statusClass = 'status-error';
                        statusText = 'ã‚¨ãƒ©ãƒ¼';
                        break;
                    default:
                        statusClass = 'status-pending';
                        statusText = 'æœªæ¥ç¶š';
                }
                
                this.connectionStatus.className = `status-dot ${statusClass}`;
                this.connectionText.textContent = statusText;
            }

            updateConfigDisplay() {
                const status = getGoogleSheetsStatus();
                const credentials = googleSheetsConfig.getCredentials();
                
                document.getElementById('configApiStatus').textContent = 
                    credentials.apiKey ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š';
                document.getElementById('configSheetStatus').textContent = 
                    credentials.sheetId ? 'è¨­å®šæ¸ˆã¿' : 'æœªè¨­å®š';
                document.getElementById('configMode').textContent = 
                    status.isAuthenticated ? 'ãƒ©ã‚¤ãƒ–' : 'ãƒ‡ãƒ¢';
            }

            log(message, type = 'info') {
                const timestamp = new Date().toLocaleTimeString('ja-JP');
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${type}`;
                logEntry.textContent = `[${timestamp}] ${message}`;
                
                this.logOutput.appendChild(logEntry);
                this.logOutput.scrollTop = this.logOutput.scrollHeight;
            }

            clearLog() {
                this.logOutput.innerHTML = '<div class="log-entry log-info">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ</div>';
            }
        }

        // Initialize demo when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new GoogleSheetsDemo();
        });
    </script>
</body>
</html>